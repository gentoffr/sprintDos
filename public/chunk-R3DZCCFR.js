import{a as N}from"./chunk-57XFV6CK.js";import{a as K}from"./chunk-3WFIUOOG.js";import{a as q,b as g,c as B,d as G,f as j,g as L,h as A,i as $,k as U,m as Y}from"./chunk-ZZLYJSMT.js";import{a as H,b as J}from"./chunk-E62EBHYI.js";import{A as d,E as m,F as o,G as n,H as f,I as O,J as I,K as P,L as C,M as _,Q as R,R as S,S as a,U as x,da as k,ka as T,la as V,m as v,n as w,oa as D,s as b,t as s,ua as z,v as u,w as y}from"./chunk-RPINSWGJ.js";import"./chunk-LJ5XHLMQ.js";import{h as E}from"./chunk-FK42CRUA.js";function X(t,r){t&1&&(o(0,"div",20),a(1," Ingresa un correo v\xE1lido. "),n())}function Z(t,r){t&1&&(o(0,"div",20),a(1," La contrase\xF1a debe tener al menos 6 caracteres. "),n())}function ee(t,r){t&1&&(o(0,"div",20),a(1," Debes confirmar la contrase\xF1a. "),n())}function te(t,r){t&1&&(o(0,"div",20),a(1," Las contrase\xF1as no coinciden. "),n())}function ie(t,r){if(t&1&&(O(0),f(1,"img",21),a(2),I()),t&2){let i,e=_();s(),m("src",e.getBanderaSeleccionada(),b),s(),x(" ",(i=e.getPaisSeleccionado())==null?null:i.nombre," ")}}function ne(t,r){t&1&&(o(0,"span",22),a(1,"Selecciona tu pa\xEDs"),n())}function re(t,r){if(t&1){let i=P();o(0,"li",25),C("click",function(){let l,p=v(i).$implicit,c=_(2);return(l=c.registerForm.get("pais"))==null||l.setValue(p.codigo),w(c.showDropdown=!1)}),f(1,"img",21),a(2),n()}if(t&2){let i,e=r.$implicit,l=_(2);S("selected",((i=l.registerForm.get("pais"))==null?null:i.value)===e.codigo),s(),m("src","https://flagcdn.com/24x18/"+e.codigo+".png",b),s(),x(" ",e.nombre," ")}}function oe(t,r){if(t&1&&(o(0,"ul",23),d(1,re,3,4,"li",24),n()),t&2){let i=_();s(),m("ngForOf",i.paises)}}function ae(t,r){t&1&&(o(0,"div",20),a(1," Selecciona un pa\xEDs. "),n())}function se(t,r){if(t&1&&(o(0,"div",26),a(1),n()),t&2){let i=_();s(),x(" ",i.registerError," ")}}var Q=class t{constructor(r,i,e,l,p){this.toast=r;this.fb=i;this.supabaseService=e;this.auth=l;this.paisService=p;this.registerForm=this.fb.group({email:["",[g.required,g.email]],password:["",[g.required,g.minLength(6)]],confirmPassword:["",[g.required]],pais:["",g.required]},{validators:this.passwordsMatchValidator}),this.paises=this.paisService.getPaises()}registerForm;registerError="";paises=[];showDropdown=!1;passwordsMatchValidator=r=>{let i=r.get("password")?.value,e=r.get("confirmPassword")?.value;return i===e?null:{passwordsMismatch:!0}};getPaisSeleccionado(){let r=this.registerForm.get("pais")?.value;return this.paises.find(i=>i.codigo===r)}getBanderaSeleccionada(){let r=this.getPaisSeleccionado();return r?`https://flagcdn.com/24x18/${r.codigo}.png`:""}onSubmit(){return E(this,null,function*(){if(this.registerForm.valid){let{email:i,password:e,pais:l}=this.registerForm.value;var r=yield this.auth.register(i,e,l);yield this.auth.login(i,e).then(({error:p})=>{if(p){this.toast.show("Error al registrar: "+p,"error");return}this.auth.redirectToHome()})}else this.registerError="Por favor completa todos los campos correctamente."})}static \u0275fac=function(i){return new(i||t)(u(N),u(U),u(H),u(J),u(K))};static \u0275cmp=y({type:t,selectors:[["app-registro"]],decls:39,vars:13,consts:[["placeholder",""],[1,"login-container"],[3,"ngSubmit","formGroup"],["for","email"],["type","email","id","email","formControlName","email","required",""],["style","color: #e63946; font-size: 0.9em;",4,"ngIf"],["for","password"],["type","password","id","password","formControlName","password","required",""],["for","confirmPassword"],["type","password","id","confirmPassword","formControlName","confirmPassword","required",""],[1,"pais-dropdown-group"],["for","pais"],["tabindex","0",1,"pais-dropdown",3,"click","blur"],[1,"pais-selected"],[4,"ngIf","ngIfElse"],[1,"dropdown-arrow"],["class","pais-list",4,"ngIf"],["type","submit",3,"disabled"],["style","color: #e63946; margin-top: 1em;",4,"ngIf"],["routerLink","/login"],[2,"color","#e63946","font-size","0.9em"],["width","24","height","18",2,"vertical-align","middle","margin-right","8px","border-radius","3px",3,"src"],[1,"pais-placeholder"],[1,"pais-list"],[3,"selected","click",4,"ngFor","ngForOf"],[3,"click"],[2,"color","#e63946","margin-top","1em"]],template:function(i,e){if(i&1){let l=P();o(0,"div",1)(1,"h2"),a(2,"Registro"),n(),o(3,"form",2),C("ngSubmit",function(){return v(l),w(e.onSubmit())}),o(4,"div")(5,"label",3),a(6,"Correo electr\xF3nico:"),n(),f(7,"input",4),d(8,X,2,0,"div",5),n(),o(9,"div")(10,"label",6),a(11,"Contrase\xF1a:"),n(),f(12,"input",7),d(13,Z,2,0,"div",5),n(),o(14,"div")(15,"label",8),a(16,"Confirmar contrase\xF1a:"),n(),f(17,"input",9),d(18,ee,2,0,"div",5)(19,te,2,0,"div",5),n(),o(20,"div",10)(21,"label",11),a(22,"Pa\xEDs:"),n(),o(23,"div",12),C("click",function(){return v(l),w(e.showDropdown=!e.showDropdown)})("blur",function(){return v(l),w(e.showDropdown=!1)}),o(24,"div",13),d(25,ie,3,2,"ng-container",14)(26,ne,2,0,"ng-template",null,0,k),o(28,"span",15),a(29,"\u25BC"),n()(),d(30,oe,2,1,"ul",16),n(),d(31,ae,2,0,"div",5),n(),o(32,"button",17),a(33,"Registrarse"),n(),d(34,se,2,1,"div",18),o(35,"div"),a(36," \xBFYa tienes una cuenta? "),o(37,"a",19),a(38,"Inicia sesi\xF3n"),n()()()()}if(i&2){let l,p,c,F,M,h,W=R(27);s(3),m("formGroup",e.registerForm),s(5),m("ngIf",((l=e.registerForm.get("email"))==null?null:l.invalid)&&((l=e.registerForm.get("email"))==null?null:l.touched)),s(5),m("ngIf",((p=e.registerForm.get("password"))==null?null:p.invalid)&&((p=e.registerForm.get("password"))==null?null:p.touched)),s(5),m("ngIf",((c=e.registerForm.get("confirmPassword"))==null?null:c.invalid)&&((c=e.registerForm.get("confirmPassword"))==null?null:c.touched)),s(),m("ngIf",e.registerForm.hasError("passwordsMismatch")&&((F=e.registerForm.get("confirmPassword"))==null?null:F.touched)),s(4),S("open",e.showDropdown),s(2),m("ngIf",(M=e.registerForm.get("pais"))==null?null:M.value)("ngIfElse",W),s(5),m("ngIf",e.showDropdown),s(),m("ngIf",((h=e.registerForm.get("pais"))==null?null:h.invalid)&&((h=e.registerForm.get("pais"))==null?null:h.touched)),s(),m("disabled",e.registerForm.invalid),s(2),m("ngIf",e.registerError)}},dependencies:[Y,j,q,B,G,$,L,A,D,T,V,z],styles:[".pais-dropdown-group[_ngcontent-%COMP%]{margin-bottom:1.2rem}.pais-dropdown[_ngcontent-%COMP%]{position:relative;width:100%;background:#f8f8fa;border:1.5px solid #c9c9c9;border-radius:8px;cursor:pointer;transition:border .2s;min-height:44px;outline:none}.pais-dropdown.open[_ngcontent-%COMP%], .pais-dropdown[_ngcontent-%COMP%]:focus{border:1.5px solid #5f6fff;box-shadow:0 2px 8px #5e6fff14}.pais-selected[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.7rem 1rem;font-size:1rem;color:#22223b;-webkit-user-select:none;user-select:none}.pais-placeholder[_ngcontent-%COMP%]{color:#aaa}.dropdown-arrow[_ngcontent-%COMP%]{margin-left:auto;font-size:1.1em;color:#888}.pais-list[_ngcontent-%COMP%]{position:absolute;left:0;right:0;top:100%;z-index:10;background:#fff;border:1.5px solid #5f6fff;border-radius:0 0 8px 8px;max-height:220px;overflow-y:auto;box-shadow:0 8px 32px #5e6fff21;margin:0;padding:0;list-style:none}.pais-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.6rem 1rem;cursor:pointer;font-size:1rem;transition:background .15s}.pais-list[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%], .pais-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:#f0f4ff}.login-container[_ngcontent-%COMP%]{max-width:350px;margin:60px auto;padding:2.5rem 2rem;background:#fff;border-radius:18px;box-shadow:0 6px 32px #00000021;display:flex;flex-direction:column;align-items:center}.login-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:1.5rem;color:#22223b;font-weight:700;font-size:2rem}.login-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:1.2rem}.login-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:1rem;color:#4a4e69;margin-bottom:.3rem;font-weight:500}.login-container[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], .login-container[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]{width:90%;padding:.7rem 1rem;border:1px solid #c9c9c9;border-radius:8px;font-size:1rem;background:#f8f8fa;transition:border .2s}.login-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border:1.5px solid #5f6fff;outline:none}.login-container[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{margin-top:.5rem;padding:.8rem 0;background:linear-gradient(90deg,#5f6fff 60%,#4ea8de);color:#fff;border:none;border-radius:8px;font-size:1.1rem;font-weight:600;cursor:pointer;box-shadow:0 2px 8px #5e6fff14;transition:background .2s,transform .1s}.login-container[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:hover{background:linear-gradient(90deg,#4ea8de 60%,#5f6fff);transform:translateY(-2px) scale(1.03)}"]})};export{Q as RegistroComponent};
